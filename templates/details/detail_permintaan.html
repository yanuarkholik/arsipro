{% extends '../index.html' %}
{% load static %}
{% load humanize %} 
{% load crispy_forms_tags %}

{% block url %}
<div class="d-flex justify-content-between m-auto">
	<div class="nav-item active">
		<a class="nav-link font-weight-normal text-secondary" href="{% url 'home' %}">Semua Desain</a>
	</div>
	<div class="nav-item">
		<div class="dropdown">
			<a class="dropdown-toggle nav-link font-weight-normal text-secondary" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				Daftar Ruangan
			</a>
		  
			<div class="dropdown-menu m-2 bg-light border border-light" aria-labelledby="dropdownMenuLink">
				{% for d in gigs %}
				<a class="dropdown-item" href="#">{{ d.jenis_ruangan }}</a>
				{% endfor %}
			</div>
		  </div>
		</div>
	</div>
	<div class="nav-item">
		<div class="dropdown">
			<a class="dropdown-toggle nav-link font-weight-normal text-secondary" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				Daftar Professional
			</a>
		  
			<div class="dropdown-menu m-2 bg-light border border-light" aria-labelledby="dropdownMenuLink">
				{% for d in gigs %}
				<a class="dropdown-item" href="#">{{ d.kategori }}</a>
				{% endfor %}
			</div>
		  </div>
		</div>
	</div>
</div>
{% endblock %}

{% block content %}
<section class="mt-3 mb-3">
	<div class="container" style="max-width: 95%;">
		<div class="row">
			<div class="col-lg-8">
				<div class="col-lg-12 p-3 bg-white rounded shadow-sm">
					<nav>
						<div class="d-flex justify-content-between">
							<small class="text-uppercase text-warning font-weight-bold">
								Dalam Antrian
							</small>
							<small class="text-uppercase text-primary font-weight-bold">
								Dalam Pengerjaan
							</small>
							<small class="text-uppercase text-success font-weight-bold">
								Selesai
							</small>
						</div>
					</nav>
					{% if object.status == 'Dalam Pengerjaan' %}
					<div class="progress m-3" style="height: 3px;">
						<div class="progress-bar" role="progressbar" style="width: 50%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
					</div>
					{% elif object.status == 'Selesai' %}
					<div class="progress m-3" style="height: 3px;">
						<div class="progress-bar bg-success" role="progressbar" style="width: 100%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
					</div>
					{% else %}
					<div class="progress m-3" style="height: 3px;">
						<div class="progress-bar bg-danger" role="progressbar" style="width: 1%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
					</div>
					{% endif %}
					<img class="card-img-top mt-3 mt-3" src="{{ object.image.url }}" alt="{{ object.oleh }}" style="height: 300px; object-fit: cover;">
					<small class="text-secondary">Gambar telah di kompresi, preview selengkapnya ada di download document**</small>  <br> <br>
					<nav class="mt-3 mb-4">
						<div class="mb-2 d-flex justify-content-between mb-3">
							<small class="text-uppercase font-weight-bold">
								No. ID
							</small>
							<small class="text-uppercase font-weight-normal">
								{{ object.id }}
							</small>
						</div>
						<div class="mb-2 d-flex justify-content-between mb-3">
							<small class="text-uppercase font-weight-bold">
								Nama
							</small>
							<small class="text-uppercase font-weight-normal">
								{{ object.nama_depan }}
								{{ object.nama_belakang }}
							</small>
						</div>
						<div class="mb-3 d-flex justify-content-between">
							<small class="text-uppercase font-weight-bold">
								Status
							</small>
							<small class="text-uppercase font-weight-bold">
								{{ object.status }}
							</small>
						</div>
						<div class="mb-3 d-flex justify-content-between">
							<small class="text-uppercase font-weight-bold">
								Link
							</small>
							<small class="text-uppercase font-weight-normal text-right">
								{{ object.link }}
							</small>
						</div>
						<div class="mb-3 d-flex justify-content-between">
							<small class="text-uppercase font-weight-bold">
								Kontak
							</small>
							<small class="text-uppercase font-weight-normal text-right">
								{{ object.kontak }}<br>
								{{ object.email }}
							</small>
						</div>
						<div class="mb-3 d-flex justify-content-between">
							<small class="text-uppercase font-weight-bold">
								Alamat
							</small>
							<small class="text-uppercase font-weight-normal text-right">
								{{ object.kota }}, {{ object.provinsi }} <br>
								{{ object.alamat }}
							</small>
						</div>
					</nav>
					<small class="text-uppercase font-weight-bold mt-3 mb-3">
						Deskripsi <br>
					</small>
					<small class="text-uppercase font-weight-normal mt-3 mb-3">
						{{ object.deskripsi|linebreaks }} <br>
					</small>
					<br>
					<br>
					{% if object.status == 'Dalam Pengerjaan' %}
							<!-- Button trigger modal -->
							<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#btnUbah" disabled>
								Ubah
							</button>
							
							<!-- Modal -->
							<div class="modal fade" id="btnUbah" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
								<div class="modal-dialog modal-dialog-centered" role="document"  style="max-width: 95%;">
								<div class="modal-content">
									<div class="modal-header">
									<h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
									<button type="button" class="close" data-dismiss="modal" aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
									</div>
									<div class="modal-body">
										<div class="col-lg-12">
											<form action="" method="POST">
												{% csrf_token %}
												<div class="row">
													<div class="col-lg-6">
														{{ form.nama_depan|as_crispy_field }}
													</div>
													<div class="col-lg-6">
														{{ form.nama_belakang|as_crispy_field }}
													</div>
													<div class="col-lg-3">
														{{ form.email|as_crispy_field }}
													</div>
													<div class="col-lg-3">
														{{ form.kontak|as_crispy_field }}
													</div>
													<div class="col-lg-3">
														{{ form.jumlah_budget|as_crispy_field }}
													</div>
													<div class="col-lg-3">
														{{ form.services|as_crispy_field }}
													</div>
													<div class="col-lg-12 mt-5 mb-3">
														<h5 class="">Pastikan isi alamat anda dengan benar</h5>
													</div>
													<div class="col-lg-4">
														{{ form.alamat|as_crispy_field }}
													</div>
													<div class="col-lg-4">
														{{ form.kota|as_crispy_field }}
													</div>
													<div class="col-lg-4">
														{{ form.provinsi|as_crispy_field }}
													</div><br>
													<div class="col-lg-12">
														{{ form.deskripsi|as_crispy_field }}
													</div>
													<div class="col-lg-6">
														{{ form.link|as_crispy_field }}
														<small class="text-secondary mt-0">Cantumkan link dokumen deskripsi jika perlu**</small>
													</div>
													<div class="col-lg-6">
														{{ form.jenis_ruangan|as_crispy_field }}
													</div><br>
													<div class="col-lg-3 mt-4">
														{% if user.is_authenticated %}
														<input class="btn btn-outline-info btn-block" type="submit" name="Kirim" id="" value="Kirim">
														{% else %}
														<input class="btn btn-outline-info btn-block" type="submit" name="Kirim" id="" value="Kirim" disabled>
														<small class="text-secondary">Anda harus login terlebih <dahulu></dahulu></small>
														{% endif %}
													</div>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
							</div>
						{% elif object.status == 'Selesai' %}
						<a role="button" href="{% url 'profile' %}"  class="btn btn-primary">Kembali</a>
						{% else %}
							<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#btnUbah">
								Ubah
							</button>
							<a role="button" href="{% url 'delete-permintaan' object.id %}"  class="btn btn-danger">Batalkan</a>
							
							<!-- Modal -->
							<div class="modal fade" id="btnUbah" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
								<div class="modal-dialog modal-dialog-centered" role="document"  style="max-width: 95%;">
								<div class="modal-content">
									<div class="modal-header">
									<h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
									<button type="button" class="close" data-dismiss="modal" aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
									</div>
									<div class="modal-body">
										<div class="col-lg-12">
											<form action="" method="POST">
												{% csrf_token %}
												<div class="row">
													<div class="col-lg-6">
														{{ form.nama_depan|as_crispy_field }}
													</div>
													<div class="col-lg-6">
														{{ form.nama_belakang|as_crispy_field }}
													</div>
													<div class="col-lg-3">
														{{ form.email|as_crispy_field }}
													</div>
													<div class="col-lg-3">
														{{ form.kontak|as_crispy_field }}
													</div>
													<div class="col-lg-3">
														{{ form.jumlah_budget|as_crispy_field }}
													</div>
													<div class="col-lg-3">
														{{ form.services|as_crispy_field }}
													</div>
													<div class="col-lg-12 mt-5 mb-3">
														<h5 class="">Pastikan isi alamat anda dengan benar</h5>
													</div>
													<div class="col-lg-4">
														{{ form.alamat|as_crispy_field }}
													</div>
													<div class="col-lg-4">
														{{ form.kota|as_crispy_field }}
													</div>
													<div class="col-lg-4">
														{{ form.provinsi|as_crispy_field }}
													</div><br>
													<div class="col-lg-12">
														{{ form.deskripsi|as_crispy_field }}
													</div>
													<div class="col-lg-6">
														{{ form.link|as_crispy_field }}
														<small class="text-secondary mt-0">Cantumkan link dokumen deskripsi jika perlu**</small>
													</div>
													<div class="col-lg-6">
														{{ form.jenis_ruangan|as_crispy_field }}
													</div><br>
													<div class="col-lg-3 mt-4">
														{% if user.is_authenticated %}
														<input class="btn btn-outline-info btn-block" type="submit" name="Kirim" id="" value="Kirim">
														{% else %}
														<input class="btn btn-outline-info btn-block" type="submit" name="Kirim" id="" value="Kirim" disabled>
														<small class="text-secondary">Anda harus login terlebih <dahulu></dahulu></small>
														{% endif %}
													</div>
												</div>
											</form>
										</div>
									</div>
									<div class="modal-footer">
									<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
									<button type="button" class="btn btn-primary">Save changes</button>
									</div>
								</div>
							</div>
							</div>
						{% endif %}
				</div>
			</div>
			<div class="col-lg-4 ">
				<div class="sticky shadow-sm rounded p-4 bg-white">
					<nav class=" d-flex justify-content-between m-auto p-0">
						<div class="nav-item ">
							<p class="font-weight-bold" style="font-size: large;">
								Estimasi Biaya
							</p>
						</div>
						<div class="nav-item">
							<p class="font-weight-normal" style="font-size: larger;">
								IDR {{ object.jumlah_budget|intcomma }}
							</p>
						</div>
					</nav>
					
					<nav class="d-flex justify-content-between m-auto p-0">
						<div class="nav-item">
							<p class="font-weight-bold text-secondary" style="font-size: small;">
								Tanggal Pemesanan
							</p>
						</div>
						<div class="nav-item">
							<p class="font-weight-normal text-secondary" style="font-size: small;">
								{{ object.buat|date:'M d,Y' }}
							</p>
						</div>
					</nav>
					{% if object.status == 'Dalam Pengerjaan' %}
					<nav class="d-flex justify-content-between m-auto p-0">
						<div class="nav-item">
							<p class="font-weight-bold text-secondary" style="font-size: small;">
								Tanggal Pengerjaan
							</p>
						</div>
						<div class="nav-item">
							<p class="font-weight-normal text-secondary" style="font-size: small;">
								{{ object.tanggal_pengerjaan|date:'M d,Y'}}
							</p>
						</div>
					</nav>
					{% elif object.status == 'Selesai' %}		
					<nav class="d-flex justify-content-between m-auto p-0">
						<div class="nav-item">
							<p class="font-weight-bold text-secondary" style="font-size: small;">
								Tanggal Pengerjaan
							</p>
						</div>
						<div class="nav-item">
							<p class="font-weight-normal text-secondary" style="font-size: small;">
								{{ object.tanggal_pengerjaan|date:'M d,Y'}}
							</p>
						</div>
					</nav>
					<nav class="d-flex justify-content-between m-auto p-0">
						<div class="nav-item">
							<p class="font-weight-bold text-secondary" style="font-size: small;">
								Tanggal Selesai
							</p>
						</div>
						<div class="nav-item">
							<p class="font-weight-normal text-secondary" style="font-size: small;">
								{{ object.tanggal_selesai|date:'M d,Y'}}
							</p>
						</div>
					</nav>
					<button type="submit" class="btn btn-primary btn-block" onclick="window.open('{{ object.files.url }}')">Download Document</button>
					{% endif %}
				</div>
			</div>
        </div>
    </div>
</section>
{% endblock %}